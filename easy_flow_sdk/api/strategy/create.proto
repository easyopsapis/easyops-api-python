syntax = "proto3";
package strategy;




import "model/easy_flow/deploy_batch_target.proto";
import "model/cmdb/cluster_info.proto";
import "model/easy_flow/target_info.proto";
import "model/easy_flow/deploy_strategy.proto";

/*
Create请求
*/
message CreateRequest {
message App {
    /*
    应用名
    */
    string name = 1 ;
    /*
    应用Id
    */
    string appId = 2 ;
}
        
message BatchStrategy {
message AutoBatch {
    /*
    自动分批:每批次部署机器数;手动分批:部署总共批次
    */
    int32 batchNum = 1 ;
    /*
    部署间隔时长(s)
    */
    int32 batchInterval = 2 ;
    /*
    是否失败暂停
    */
    string failedStop = 3 ;
}
        
message ManualBatch {
message Batches {
    /*
    批次主机列表
    */
    repeated easy_flow.DeployBatchTarget targets = 1 ;
}
        
    
    /*
    分批详情
    */
    repeated Batches batches = 1 ;
    /*
    自动分批:每批次部署机器数;手动分批:部署总共批次
    */
    int32 batchNum = 2 ;
    /*
    部署间隔时长(s)
    */
    int32 batchInterval = 3 ;
    /*
    是否失败暂停
    */
    string failedStop = 4 ;
}
        
    
    /*
    自动批量策略信息
    */
    AutoBatch autoBatch = 1 ;
    /*
    手动批量
    */
    ManualBatch manualBatch = 2 ;
    /*
    分批类型
    */
    string type = 3 ;
}
        
message PackageList {
    /*
    集群
    */
    cmdb.ClusterInfo cluster = 1 ;
    /*
    目标版本
    */
    string targetVersion = 2 ;
    /*
    是否提前暂停
    */
    string preStop = 3 ;
    /*
    是否发布重启
    */
    string postRestart = 4 ;
    /*
    是否自动运行
    */
    string autoStart = 5 ;
    /*
    是否需要用户检查
    */
    string userCheck = 6 ;
    /*
    是否完全更新
    */
    string fullUpdate = 7 ;
    /*
    强制更新
    */
    string force = 8 ;
    /*
    强制安装
    */
    string forceInstall = 9 ;
    /*
    包Id
    */
    string packageId = 10 ;
    /*
    包名称
    */
    string name = 11 ;
    /*
    安装路径
    */
    string installPath = 12 ;
    /*
    版本类型 1 程序包,  2 配置包,  4 文件包
    */
    int32 type = 13 ;
    /*
    平台
    */
    string platform = 14 ;
}
        
message Status {
    /*
    是否过时
    */
    string outOfDate = 1 ;
}
        
    
    /*
    策略Id，策略Id自动生成
    */
    string id = 1 ;
    /*
    策略名称
    */
    string name = 2 ;
    /*
    api版本
    */
    string apiVersion = 3 ;
    /*
    组织
    */
    int32 org = 4 ;
    /*
    应用相关信息
    */
    App app = 5 ;
    /*
    策略类型
    */
    string type = 6 ;
    /*
    批量策略信息
    */
    BatchStrategy batchStrategy = 7 ;
    /*
    范围
    */
    string scope = 8 ;
    /*
    集群列表
    */
    repeated cmdb.ClusterInfo clusters = 9 ;
    /*
    目标设备列表
    */
    repeated easy_flow.TargetInfo targetList = 10 ;
    /*
    集群环境
    */
    string clusterEnvironment = 11 ;
    /*
    集群类型
    */
    string clusterType = 12 ;
    /*
    部署包信息
    */
    PackageList packageList = 13 ;
    /*
    部署策略状态
    */
    Status status = 14 ;
}

/*
CreateApi返回
*/
message CreateResponseWrapper {
    /*
    返回码
    */
    int32 code = 1 ;
    /*
    返回码解释
    */
    string codeExplain = 2 ;
    /*
    错误详情
    */
    string error = 3 ;
    /*
    返回数据
    */
    easy_flow.DeployStrategy data = 4 ;
}

